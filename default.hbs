<!DOCTYPE html>
<html lang="{{@site.locale}}">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>{{meta_title}}</title>

    <link rel="stylesheet" href="{{asset "built/screen.css"}}">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.32.2/dist/tocbot.min.css">
    {{ghost_head}}
</head>

<body class="{{body_class}}{{{block "body_class"}}} is-head-left-logo{{#match @custom.title_font "=" "Elegant serif"}} has-serif-title{{/match}}{{#match @custom.body_font "=" "Elegant serif"}} has-serif-body{{/match}}{{^is "home"}}{{#if @site.cover_image}} is-head-brand{{/if}}{{/is}}">
<div class="site">
    <header id="gh-head" class="gh-head gh-outer">
        <div class="gh-head-inner">
            <div class="gh-head-brand">
                <div class="gh-head-brand-wrapper">
                    <a class="gh-head-logo" href="{{@site.url}}">
                        {{#if @site.logo}}
                            <img src="{{@site.logo}}" alt="{{@site.title}}">
                        {{else}}
                            {{@site.title}}
                        {{/if}}
                    </a>
                </div>
                <button class="gh-burger"></button>
            </div>

            <nav class="gh-head-menu">
                {{navigation}}
            </nav>

            <div class="gh-head-actions">
                {{> "darkmode"}}
            </div>
        </div>
    </header>

    {{#is "home"}}
        {{> "cover"}}
        {{#if @custom.show_featured_posts}}
            {{> "featured-posts"}}
        {{/if}}
    {{/is}}

    <div class="site-content">
        {{{body}}}
    </div>

    <footer class="gh-foot{{#unless @site.secondary_navigation}} no-menu{{/unless}} gh-outer">
        <div class="gh-foot-inner gh-inner">
            <div class="gh-copyright">
                <a href="{{@site.url}}">{{@site.title}}</a> Â© {{date format="YYYY"}}
            </div>
            {{#if @site.secondary_navigation}}
                <nav class="gh-foot-menu">
                    {{navigation type="secondary"}}
                </nav>
            {{/if}}
            <div class="gh-powered-by">
                Published with <a href="https://ghost.org/" target="_blank" rel="noopener">Ghost</a>
            </div>
        </div>
    </footer>
</div>

{{#is "post, page"}}
    {{> "pswp"}}
{{/is}}

{{!-- Fixes 100vh issue on mobile browsers with toolbar on the bottom --}}
<script>
    if (document.body.classList.contains('with-full-cover') && (/Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.platform))) {
        document.getElementsByClassName('cover')[0].style.height = window.innerHeight + 'px';
    }
</script>

<script src="{{asset "built/main.min.js"}}"></script>
<script src="https://cdn.jsdelivr.net/npm/tocbot@4.32.2/dist/tocbot.min.js"></script>
<script>
    const parent = document.querySelector(".gh-content.gh-canvas");
    const asideElement = document.createElement("aside");
    asideElement.setAttribute("class", "gh-sidebar");

    const containerElement = document.createElement("div");
    containerElement.setAttribute("class", "gh-toc-container");

    const divElement = document.createElement("div");
    divElement.setAttribute("class", "gh-toc");
    containerElement.appendChild(divElement);

    asideElement.appendChild(containerElement);
    parent.insertBefore(asideElement, parent.firstChild);

    tocbot.init({
        tocSelector: '.gh-toc',
        contentSelector: '.gh-content',
        headingSelector: 'h1, h2, h3, h4',
        ignoreSelector: 'h4.kg-toggle-heading-text',
        hasInnerContainers: true,
        orderedList: false,
        collapseDepth: 6,
        enableUrlHashUpdateOnScroll: true,
    });

    const toc = document.querySelector(".gh-toc");
    const sidebar = document.querySelector(".gh-sidebar");
    const tocItems = toc.querySelectorAll('li').length;

    if (tocItems < 2) {
        sidebar.style.display = 'none';
    }
</script>

{{ghost_foot}}

</body>
</html>
